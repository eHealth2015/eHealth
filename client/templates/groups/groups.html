<template name="groups">
	<h1>{{strings.header}}</h1>

	<!-- People -->
	<!-- Row with header people and add button -->
	<div class="ui grid">
		<div class="eleven wide column">
			<h4>{{strings.people}}</h4>
		</div>
		<div class="five wide column right">
			{{#if isUserMedic}}
			<div class="ui labeled icon buttons">
				<button id="addPatient" class="ui tealbis button">
					<i class="plus icon"></i>
					Add
				</button>
			</div>
			{{/if}}
		</div>
	</div>

	<!-- hidden add patient row -->
	{{#if isUserMedic}}
	<div class="adding-patient" style="display:none;">
		<div class="big-spacing"></div>
		<form id="addPatientForm" class="ui form">
			<div class="field">
				<input type="text" name="patient-first-name" placeholder="First name" id="addPatientFirstName">
			</div>
			<div class="field">
				<input type="text" name="patient-last-name" placeholder="Last name" id="addPatientLastName">
			</div>
			<div class="ui buttons">
				<button class="ui positive button" id="confirmeAddPatient" >Add</button>
				<div class="or"></div>
				<button class="ui button" id="cancelAddPatient">Cancel</button>
			</div>
		</form>
	</div>
	{{/if}}

	<!-- people table -->
	{{#if people}}
	<table class="ui striped table">
		<thead>
			<tr>
				<th>First Name</th>
				<th>Last Name</th>
				{{#if isUserMedic}}
				<th>Last data</th>
				{{/if}}
				<th>Actions</th>
			</tr>
		</thead>
		<tbody>
			{{#each people}}
			<tr>
				<td>{{firstName}}</td>
				<td>{{lastName}}</td>
				{{#if isUserMedic}}
					<td>Last data</td>
					<!-- other fields... -->
				{{/if}}
				<td>
					<button receiverId="{{_id}}" class="ui tiny yellow basic icon button newMessage">
						<i class="mail outline icon"></i>
						Message
					</button>
					<button class="ui tiny red basic icon button" id="deletePatientFromMedic" patientId="{{_id}}">
						<i class="remove icon"></i>
						Remove
					</button>
				</td>
			</tr>
			{{/each}}
		</tbody>
	</table>
	{{else}}
		<div class="italic">
			<div class="big-spacing"></div>
			<i class="warning circle icon"></i>
			<span>You don't have any {{strings.peopleType}}.</span>
		</div>
	{{/if}}

	<div class="huge-spacing"></div>

	<!-- Groups -->
	<!-- Row with header groups and add button -->
	<div class="ui grid">
		<div class="eleven wide column">
			<h4>{{strings.groups}}</h4>
		</div>
		<div class="five wide column right">
			{{#if isUserMedic}}
			<div class="ui labeled icon buttons">
				<button id="addGroup" class="ui tealbis button">
					<i class="plus icon"></i>
					Add
				</button>
			</div>
			{{/if}}
		</div>
	</div>

	<!-- hidden add group row -->
	<div class="adding-group" style="display:none;">
		<div class="big-spacing"></div>
		<form id="addGroupForm" class="ui form">
			<div class="field">
				<input type="text" name="group-name" placeholder="Group name" id="groupName">
			</div>
			<div class="ui buttons">
				<button class="ui positive button" id="confirmAddGroup">Add</button>
				<div class="or"></div>
				<button class="ui button" id="cancelAddGroup">Cancel</button>
			</div>
		</form>
	</div>

	<!-- groups table -->
	{{#if groups}}
	<table class="ui striped table">
		<thead>
		<tr>
			<th>Name</th>
			{{#if isUserMedic}}
			<th>Members</th>
			<th>Patients</th>
			{{/if}}
			<th>Actions</th>
		</tr>
		</thead>
		<tbody>
		{{#each groups}}
			<tr>
				<td>{{name}}</td>
				{{#if isUserMedic}}
				<td>{{medics.length}}</td>
				<td>{{patients.length}}</td>
				{{/if}}
				<td>
					<a href="#{{_id}}" id="showGroupDetails" class="ui tiny yellow basic icon button">
						<i class="info icon"></i>
						Details
					</a>
				</td>
			</tr>
		{{/each}}
		</tbody>
	</table>
	{{else}}
		<div class="big-spacing"></div>
		<div class="italic">
			<i class="warning circle icon"></i>
			<span>You don't have any group.</span>
		</div>
	{{/if}}

	<div class="huge-spacing"></div>

	<!-- REMARQUES
	remarques:<br>
	(accès pour plus d'info sur le patient ? accordéon ?)<br>
	(todo: remove patient with confirmation)<br>
	(todo: confimation avant suppr groupe)<br>
	(todo: harmoniser les tableaux)<br>
	(todo: espacer la fleche du bas et la croix ?)
	-->

	{{> groupDetails group}}

</template>

<template name="groupDetails">
	<div id="groupDetailsModal" class="ui modal">
		<i class="close icon"></i>

		<div class="header">
			{{name}}
		</div>

		<div class="content">

			<!-- Patients only for medics -->
			{{#if isUserMedic}}
			<!-- Patients header row and add form -->
			<div class="ui grid">
				<div class="seven wide column">
					<h4>Patients</h4>
				</div>
				{{#if admin}}
				<div class="three wide column ui input">
					<input id="addPatientFirstName2group" placeholder="First name" name="newPatientFirstName" type="text">
				</div>
				<div class="three wide column ui input">
					<input id="addPatientLastName2group" placeholder="Last name" name="newPatientLastName" type="text">
				</div>
				<div class="three wide column">
					<div class="ui labeled icon buttons">
						<button id="addPatient2group" class="ui tealbis button">
							<i class="plus icon"></i>
							Add
						</button>
					</div>
				</div>
				{{/if}}
			</div>

			<div class="big-spacing"></div>

			<!-- Patients table in groups -->
			{{#if patients}}
			<table class="ui striped table">
				<thead>
					<tr>
						<th>First name</th>
						<th>last name</th>
						<th>Gender</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					{{#each patients}}
					<tr>
						<td>{{firstName}}</td>
						<td>{{lastName}}</td>
						<td>{{gender}}</td>
						<td>
							<button peopleId="{{_id}}" class="ui tiny yellow basic icon button newMessage">
								<i class="mail outline icon"></i>
								Message
							</button>
							{{#if ../admin}}
							<button class="ui tiny red basic icon button" id="deletePatientFromGroup" patientId="{{_id}}">
								<i class="remove icon"></i>
								Remove
							</button>
							{{/if}}
						</td>
					</tr>
					{{/each}}
				</tbody>
			</table>
			{{else}}
				<div class="italic">
					<i class="warning circle icon"></i>
					<span>There is no patient.</span>
				</div>
			{{/if}}
			<div class="big-spacing"></div>
			{{/if}}

			<!-- Groups members -->
			<!-- Groups header row and add form -->
			<div class="ui grid">
				<div class="seven wide column">
					<h4>Medical staff</h4>
				</div>
				{{#if admin}}
				<div class="three wide column ui input">
					<input id="addMedicFirstName2group" placeholder="First name" name="newMedicFirstName" type="text">
				</div>
				<div class="three wide column ui input">
					<input id="addMedicLastName2group" placeholder="Last name" name="newMedicLastName" type="text">
				</div>
				<div class="three wide column">
					<div class="ui labeled icon buttons">
						<button id="addMedic2group" class="ui tealbis button">
							<i class="plus icon"></i>
							Add
						</button>
					</div>
				</div>
				{{/if}}
			</div>

			<div class="big-spacing"></div>

			<!-- Groups members table -->
			<table class="ui striped table">
				<thead>
					<tr>
						<th>Title</th>
						<th>First name</th>
						<th>last name</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					{{#each medics}}
					<tr>
						<td>{{title}}</td>
						<td>{{firstName}}</td>
						<td>{{lastName}}</td>
						<td>
							<button receiverId="{{_id}}" class="ui tiny yellow basic icon button newMessage">
								<i class="mail outline icon"></i>
								Message
							</button>
							{{#if ../admin}}
							<button class="ui tiny red basic icon button" id="deleteMedicFromGroup" medicId="{{_id}}">
								<i class="remove icon"></i>
								Remove
							</button>
							{{/if}}
						</td>
					</tr>
					{{/each}}
				</tbody>
			</table>

			<!-- admin panel -->
			{{#if admin}}
			<div class="big-spacing"></div>

			<div class="ui grid">
				<div class="three wide column ui input">
					<input id="newGroupName" value="{{name}}" name="newName" type="text">
				</div>
				<div class="four wide column">
					<button id="changeGroupName" class="ui button">Change name</button>
				</div>
				<div class="five wide column"></div>
				<div class="four wide column">
					<button id="deleteGroup1" class="ui button red">Delete the group</button>
					<button id="deleteGroup2" class="ui button red" style="display: none;">Click again to delete</button>
				</div>
			</div>
			{{/if}}
		</div>
	</div>
</template>